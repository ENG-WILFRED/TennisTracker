generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Player {
  id           String    @id @default(uuid())
  username     String    @unique
  email        String    @unique
  phone        String?   @unique
  passwordHash String // for authentication
  firstName    String
  lastName     String
  photo        String? // profile picture URL
  gender       String? // optional (Male/Female/Other)
  dateOfBirth  DateTime? // useful for age categories
  nationality  String? // country/region
  bio          String? // short profile description

  // Statistics
  matchesPlayed   Int @default(0)
  matchesRefereed Int @default(0)
  matchesBallCrew Int @default(0)
  matchesWon      Int @default(0)
  matchesLost     Int @default(0)

  // Relations
  playerBadges    PlayerBadge[]
  matchesA        Match[]         @relation("PlayerA")
  matchesB        Match[]         @relation("PlayerB")
  refereedMatches Match[]         @relation("Referee")
  ballCrewMatches MatchBallCrew[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  Match Match[]
}

model Match {
  id        String          @id @default(uuid())
  round     Int
  playerA   Player          @relation("PlayerA", fields: [playerAId], references: [id])
  playerAId String
  playerB   Player          @relation("PlayerB", fields: [playerBId], references: [id])
  playerBId String
  referee   Player?         @relation("Referee", fields: [refereeId], references: [id])
  refereeId String?
  ballCrew  MatchBallCrew[]
  winner    Player?         @relation(fields: [winnerId], references: [id])
  winnerId  String?
  group     String?
  score     String?
  createdAt DateTime        @default(now())
}

model MatchBallCrew {
  id       String @id @default(uuid())
  match    Match  @relation(fields: [matchId], references: [id])
  matchId  String
  player   Player @relation(fields: [playerId], references: [id])
  playerId String
}

model Badge {
  id           String        @id @default(uuid())
  name         String
  description  String
  category     String // e.g. "Wins", "Referee", "Participation"
  icon         String? // optional icon/image URL
  playerBadges PlayerBadge[]
}

model PlayerBadge {
  id       String   @id @default(uuid())
  player   Player   @relation(fields: [playerId], references: [id])
  playerId String
  badge    Badge    @relation(fields: [badgeId], references: [id])
  badgeId  String
  earnedAt DateTime @default(now())
}
